subroutine Hamiltonian_m2(n_atoms,b1,b2,b3,z,h,d11,d12,d13,n_lowercase,m) 
use module_Data
implicit none
integer n_atoms,  b1, b2, b3
complex*16 d11,d12,d13,d14
complex*16 z(n_atoms,n_atoms), h(n_atoms,n_atoms)
integer m1,m2,m3, x, v,x1
integer n_lowercase, m ! N-AGNR-I(n_lowercase,m)
!******************************************************************!
!******************************************************************!
do  i = 1,b2-1,2
j=i+1
z(i,j)   = d13
z(j,i)= dconjg(d13)
end do   
!
do  i = 2,b2,2
j=i+1
z(i,j)   = d12
z(j,i)= dconjg(d12)
end do
!******************************************************************!
!******************************************************************!
m1 = b2
!
do x = 0,n_lowercase-1,1
do  i = 1,2*b3,4
j=i+1
z(i+x*(2*b3)+m1,j+x*(2*b3)+m1)  = d11
z(j+x*(2*b3)+m1,i+x*(2*b3)+m1)  = dconjg(d11)
end do
!
do  i = 2,2*b3-1,2
j=i+1
z(i+x*(2*b3)+m1,j+x*(2*b3)+m1)  = d12
z(j+x*(2*b3)+m1,i+x*(2*b3)+m1)= dconjg(d12)
end do
!
do  i = 1,2*b3-2,2
j=i+3
z(i+x*(2*b3)+m1,j+x*(2*b3)+m1) = d13
z(j+x*(2*b3)+m1,i+x*(2*b3)+m1)= dconjg(d13)
end do
!          
if (x.ne.0) then
do  i= 3,2*b3,4
j=i+1+2*b3
z(i+(x-1)*(2*b3)+m1,j+(x-1)*(2*b3)+m1) = d11
z(j+(x-1)*(2*b3)+m1,i+(x-1)*(2*b3)+m1) = dconjg( d11)
end do
end if
end do
!******************************************************************!
!******************************************************************!
m2 = b2+b3*2*n_lowercase
!
do  i = 1,b2-1,2
j=i+1
z(i+m2,j+m2)  = d12
z(j+m2,i+m2)  = dconjg(d12)
end do 
!
do  i = 2,b2,2
j=i+1
z(i+m2,j+m2)    = d13
z(j+m2,i+m2)= dconjg(d13)
end do
!
do  i= 1,b2,2
j=i
z(i,j+b2+(i+2)) = d11
z(j+b2+(i+2),i) = dconjg(d11)
end do
!******************************************************************!
!******************************************************************!
m3=b2+(b3)*(2*n_lowercase-2)
!
do  i= 3,b3,2
j=i+2*b3-2
z((i-1)*2+m3-1,j+m3) = d11
z(j+m3,(i-1)*2+m3-1) = dconjg(d11)
end do
!******************************************************************!
!******************************************************************!
v=b2+(b3)*(2*n_lowercase-2)
x1 = n_lowercase
!       
do  i= 1,b2-1,2
j=i+1
z(i+x1*(2*b3)+b2+1,j) = d11
z(j,i+x1*(2*b3)+b2+1) = dconjg(d11)
end do
!******************************************************************!
!******************************************************************!
do i=1,n_atoms
do j=1,n_atoms
h(i,j)=z(i,j)
end do
end do
!******************************************************************!
!******************************************************************!    
end subroutine   
        
     
